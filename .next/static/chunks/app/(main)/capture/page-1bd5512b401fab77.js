(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[412],{8399:(e,t,r)=>{Promise.resolve().then(r.bind(r,7465))},7465:(e,t,r)=>{"use strict";r.d(t,{CameraView:()=>f});var n=r(7437),a=r(2265),s=r(495),l=r(8954),i=r(5137),o=r(1066);let c=(0,o.Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),u=(0,o.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var d=r(6463),h=r(6474);function f(){let e=(0,a.useRef)(null),t=(0,a.useRef)(null),r=(0,a.useRef)(null),o=(0,a.useRef)([]),[f,m]=(0,a.useState)(null),[p,b]=(0,a.useState)(!1),[v,g]=(0,a.useState)("environment"),[x,y]=(0,a.useState)(!1),[w,k]=(0,a.useState)(null),[j,N]=(0,a.useState)(null),[z,C]=(0,a.useState)(0),R=(0,a.useRef)(null),_=(0,d.useRouter)(),[I,E]=(0,a.useState)(1),[S,Z]=(0,a.useState)(null);(0,a.useEffect)(()=>{!async function(){try{let e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);y(e.length>1)}catch(e){console.error("Error checking devices:",e)}}()},[]);let A=(0,a.useCallback)(async()=>{f&&f.getTracks().forEach(e=>e.stop());try{let t=await navigator.mediaDevices.getUserMedia({video:{facingMode:v,width:{ideal:1920},height:{ideal:1080},aspectRatio:{ideal:9/16},zoom:!0},audio:!0});m(t),e.current&&(e.current.srcObject=t),k(null);let r=t.getVideoTracks()[0].getCapabilities();r.zoom?(Z({min:r.zoom.min,max:r.zoom.max,step:r.zoom.step}),E(r.zoom.min)):Z(null)}catch(e){console.error("Error accessing camera:",e),k("Could not access camera. Please check permissions.")}},[v]),O=async e=>{let t=parseFloat(e.target.value);if(E(t),f){let e=f.getVideoTracks()[0];try{await e.applyConstraints({advanced:[{zoom:t}]})}catch(e){console.error("Error setting zoom:",e)}}};(0,a.useEffect)(()=>(j||A(),()=>{null==f||f.getTracks().forEach(e=>e.stop()),R.current&&clearInterval(R.current)}),[A,j]);let M=()=>{if(!f)return;o.current=[];let e=new MediaRecorder(f);r.current=e,e.ondataavailable=e=>{e.data.size>0&&o.current.push(e.data)},e.onstop=()=>{let e=new Blob(o.current,{type:"video/webm"});N(URL.createObjectURL(e)),C(0),R.current&&clearInterval(R.current)},e.start(),b(!0);let t=Date.now();R.current=setInterval(()=>{let e=(Date.now()-t)/1e3;C(e),e>=15&&V()},100)},V=()=>{r.current&&"recording"===r.current.state&&(r.current.stop(),b(!1))},D=async()=>{if(j&&0!==o.current.length)try{let{data:{user:e}}=await (0,h.e)().auth.getUser();if(!e)return;let{data:t}=await (0,h.e)().from("heists").select("id").eq("status","submission").single();if(!t){console.error("No active heist found"),_.push("/feed");return}let{error:r}=await (0,h.e)().from("heist_submissions").insert({heist_id:t.id,user_id:e.id,video_url:"https://assets.mixkit.co/videos/preview/mixkit-man-dancing-under-changing-lights-1240-large.mp4",thumbnail_url:"https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=800&q=80",pitch_text:"Check out my heist plan! \uD83D\uDC7B",vote_count:0});if(r)throw r;_.push("/heist")}catch(e){console.error("Error submitting heist:",e),_.push("/heist")}};return j?(0,n.jsxs)("div",{className:"relative h-screen w-full bg-black",children:[(0,n.jsx)("video",{ref:t,src:j,autoPlay:!0,loop:!0,playsInline:!0,className:"h-full w-full object-cover"}),(0,n.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-8 flex justify-between items-center bg-gradient-to-t from-black/80 to-transparent",children:[(0,n.jsx)(s.z,{variant:"ghost",onClick:()=>{j&&URL.revokeObjectURL(j),N(null),b(!1)},className:"text-white hover:bg-white/20",children:"Retake"}),(0,n.jsx)(s.z,{onClick:D,className:"bg-yollr-peach hover:bg-yollr-peach/90 text-midnight font-bold px-8",children:"Post Moment"})]})]}):(0,n.jsxs)("div",{className:"relative h-screen w-full bg-black overflow-hidden",children:[w?(0,n.jsx)("div",{className:"flex h-full items-center justify-center text-white p-6 text-center",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(l.Z,{className:"h-12 w-12 mx-auto mb-4 text-red-500"}),(0,n.jsx)("p",{children:w}),(0,n.jsx)(s.z,{onClick:A,className:"mt-4",variant:"outline",children:"Retry"})]})}):(0,n.jsx)("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,className:"h-full w-full object-cover transition-transform duration-500 ".concat("user"===v?"scale-x-[-1]":"")}),(0,n.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe flex justify-between items-center z-10 bg-gradient-to-b from-black/40 to-transparent",children:[(0,n.jsx)(s.z,{variant:"ghost",size:"icon",onClick:()=>_.back(),className:"bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40",children:(0,n.jsx)(i.Z,{className:"h-6 w-6"})}),(0,n.jsx)("div",{className:"bg-black/20 backdrop-blur-md rounded-full px-3 py-1 text-white text-sm font-medium",children:p?"".concat(Math.ceil(15-z),"s"):"15s"}),(0,n.jsx)(s.z,{variant:"ghost",size:"icon",className:"bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40",children:(0,n.jsx)(c,{className:"h-6 w-6"})})]}),S&&(0,n.jsx)("div",{className:"absolute bottom-32 left-0 right-0 px-12 flex items-center justify-center z-20",children:(0,n.jsxs)("div",{className:"bg-black/40 backdrop-blur-md rounded-full px-4 py-2 flex items-center space-x-2 w-full max-w-xs",children:[(0,n.jsx)("span",{className:"text-white text-xs font-bold",children:"1x"}),(0,n.jsx)("input",{type:"range",min:S.min,max:S.max,step:S.step,value:I,onChange:O,className:"w-full h-1 bg-white/20 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:rounded-full"}),(0,n.jsxs)("span",{className:"text-white text-xs font-bold",children:[S.max,"x"]})]})}),(0,n.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-8 pb-12 flex justify-around items-center bg-gradient-to-t from-black/80 via-black/40 to-transparent",children:[(0,n.jsx)(s.z,{variant:"ghost",size:"icon",className:"opacity-0",children:(0,n.jsx)("div",{className:"h-10 w-10"})}),(0,n.jsxs)("div",{className:"relative",children:[p&&(0,n.jsxs)("svg",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-24 h-24 -rotate-90 pointer-events-none",children:[(0,n.jsx)("circle",{cx:"48",cy:"48",r:"46",stroke:"white",strokeWidth:"4",fill:"none",className:"opacity-30"}),(0,n.jsx)("circle",{cx:"48",cy:"48",r:"46",stroke:"#FF7A5C",strokeWidth:"4",fill:"none",strokeDasharray:289,strokeDashoffset:289-289*z/15,className:"transition-all duration-100 ease-linear"})]}),(0,n.jsx)("button",{onClick:()=>{p?V():M()},className:"h-20 w-20 rounded-full border-[6px] border-white flex items-center justify-center transition-all duration-200 ".concat(p?"bg-red-500 scale-90 border-transparent":"bg-transparent hover:scale-105"),children:p&&(0,n.jsx)("div",{className:"h-8 w-8 bg-white rounded-sm"})})]}),(0,n.jsx)(s.z,{variant:"ghost",size:"icon",onClick:()=>{g(e=>"user"===e?"environment":"user")},disabled:!x,className:"bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40 transition-opacity ".concat(x?"":"opacity-50"),children:(0,n.jsx)(u,{className:"h-6 w-6"})})]})]})}},495:(e,t,r)=>{"use strict";r.d(t,{z:()=>c});var n=r(7437),a=r(2265),s=r(1538),l=r(3027),i=r(7440);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-xl text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-[0_0_15px_rgba(255,122,92,0.4)]",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-[0_0_15px_rgba(0,233,255,0.4)]",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",glass:"bg-white/10 backdrop-blur-md border border-white/20 text-white hover:bg-white/20"},size:{default:"h-12 px-6 py-3",sm:"h-9 rounded-lg px-3",lg:"h-14 rounded-2xl px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:c=!1,...u}=e,d=c?s.g7:"button";return(0,n.jsx)(d,{className:(0,i.cn)(o({variant:a,size:l,className:r})),ref:t,...u})});c.displayName="Button"},6474:(e,t,r)=>{"use strict";r.d(t,{e:()=>a});var n=r(3290);function a(){return(0,n.AY)("https://wdpiwrdesqtlzsuxfkwc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndkcGl3cmRlc3F0bHpzdXhma3djIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NTc4NTAsImV4cCI6MjA3ODAzMzg1MH0.-aFoHj7EtEA9k54of_gyIw5DAKDSZyJlT5b4N2sUXUY")}},7440:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var n=r(4839),a=r(6164);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}},1066:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),l=(e,t)=>{let r=(0,n.forwardRef)((r,l)=>{let{color:i="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:u,className:d="",children:h,...f}=r;return(0,n.createElement)("svg",{ref:l,...a,width:o,height:o,stroke:i,strokeWidth:u?24*Number(c)/Number(o):c,className:["lucide","lucide-".concat(s(e)),d].join(" "),...f},[...t.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(h)?h:[h]])});return r.displayName="".concat(e),r}},5137:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(1066).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8954:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(1066).Z)("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]])},6463:(e,t,r)=>{"use strict";var n=r(1169);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},1584:(e,t,r)=>{"use strict";r.d(t,{F:()=>s,e:()=>l});var n=r(2265);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function s(...e){return t=>{let r=!1,n=e.map(e=>{let n=a(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():a(e[t],null)}}}}function l(...e){return n.useCallback(s(...e),e)}},1538:(e,t,r)=>{"use strict";r.d(t,{Z8:()=>u,g7:()=>d});var n,a=r(2265),s=r(1584),l=r(7437),i=Symbol.for("react.lazy"),o=(n||(n=r.t(a,2)))[" use ".trim().toString()];function c(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===i&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}function u(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:r,...n}=e;if(c(r)&&"function"==typeof o&&(r=o(r._payload)),a.isValidElement(r)){var l;let e,i;let o=(l=r,(e=Object.getOwnPropertyDescriptor(l.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?l.ref:(e=Object.getOwnPropertyDescriptor(l,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?l.props.ref:l.props.ref||l.ref),c=function(e,t){let r={...t};for(let n in t){let a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...e)=>{let t=s(...e);return a(...e),t}:a&&(r[n]=a):"style"===n?r[n]={...a,...s}:"className"===n&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==a.Fragment&&(c.ref=t?(0,s.F)(t,o):o),a.cloneElement(r,c)}return a.Children.count(r)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=a.forwardRef((e,r)=>{let{children:n,...s}=e;c(n)&&"function"==typeof o&&(n=o(n._payload));let i=a.Children.toArray(n),u=i.find(f);if(u){let e=u.props.children,n=i.map(t=>t!==u?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,l.jsx)(t,{...s,ref:r,children:a.isValidElement(e)?a.cloneElement(e,void 0,n):null})}return(0,l.jsx)(t,{...s,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}var d=u("Slot"),h=Symbol("radix.slottable");function f(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===h}},3027:(e,t,r)=>{"use strict";r.d(t,{j:()=>l});var n=r(4839);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=n.W,l=(e,t)=>r=>{var n;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:l,defaultVariants:i}=t,o=Object.keys(l).map(e=>{let t=null==r?void 0:r[e],n=null==i?void 0:i[e];if(null===t)return null;let s=a(t)||a(n);return l[e][s]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return s(e,o,null==t?void 0:null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce((e,t)=>{let{class:r,className:n,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...c}[t]):({...i,...c})[t]===r})?[...e,r,n]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}}},e=>{var t=t=>e(e.s=t);e.O(0,[868,290,130,215,744],()=>t(8399)),_N_E=e.O()}]);