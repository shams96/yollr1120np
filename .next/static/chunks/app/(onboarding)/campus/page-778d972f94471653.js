(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[409],{3805:(e,t,r)=>{Promise.resolve().then(r.bind(r,1327))},1327:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(7437),a=r(2265),o=r(3102),n=r(6463),i=r(1066);let l=(0,i.Z)("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),c=(0,i.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),d=(0,i.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var u=r(6474);function h(){let e=(0,n.useRouter)(),[t,r]=(0,a.useState)(""),[i,h]=(0,a.useState)([]),[m,f]=(0,a.useState)(!0),[p,x]=(0,a.useState)("locating"),g=(0,u.e)();(0,a.useEffect)(()=>{let e=async()=>{let{data:e,error:t}=await g.from("campuses").select("*").order("name");e&&h(e)};(async()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(async t=>{try{let{latitude:r,longitude:s}=t.coords;console.log("Got location:",r,s);let{data:a,error:o}=await g.rpc("get_nearest_campus",{user_lat:r,user_long:s});if(o)throw o;a&&a.length>0?(h(a),x("found")):e()}catch(t){console.error("RPC Error:",t),e()}finally{f(!1)}},t=>{console.warn("Geolocation denied/error:",t),x("denied"),e(),f(!1)}):(console.log("Geolocation not supported"),x("denied"),e(),f(!1))})()},[]);let w=async t=>{try{let{data:{user:r}}=await g.auth.getUser();if(!r){console.warn("No authenticated user found. Redirecting to feed anyway (demo mode)."),e.push("/feed");return}let{error:s}=await g.from("users").upsert({id:r.id,campus_id:t,xp_total:0,created_at:new Date().toISOString()},{onConflict:"id"}).select();if(s)throw console.error("Error updating user campus:",s),s;console.log("Joined campus successfully!"),e.push("/feed")}catch(t){console.error("Error joining campus:",t),e.push("/feed")}},y=i.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()));return(0,s.jsxs)("div",{className:"min-h-screen bg-midnight p-6 pt-12",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-black text-white mb-2",children:"Find your campus"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"locating"===p?"Locating you...":"found"===p?"Campuses near you":"Select your campus to join the heist."})]}),(0,s.jsxs)("div",{className:"space-y-4 mb-8",children:[m?(0,s.jsx)("div",{className:"text-white/50 text-center py-8 animate-pulse",children:"Finding nearby campuses..."}):y.map(e=>(0,s.jsxs)("button",{onClick:()=>w(e.id),className:"w-full flex items-center p-4 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 transition-all text-left group",children:[(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-yollr-cyan/20 flex items-center justify-center mr-4 group-hover:scale-110 transition-transform",children:(0,s.jsx)(l,{className:"h-6 w-6 text-yollr-cyan"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-white",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center",children:[(0,s.jsx)(c,{className:"h-3 w-3 mr-1 text-yollr-pink"}),e.location_name||"Unknown Location"]})]})]},e.id)),!m&&0===y.length&&(0,s.jsx)("div",{className:"text-white/50 text-center py-4",children:"No campuses found."})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,s.jsx)("span",{className:"w-full border-t border-white/10"})}),(0,s.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,s.jsx)("span",{className:"bg-midnight px-2 text-muted-foreground",children:"Or search manually"})})]}),(0,s.jsxs)("div",{className:"mt-6 relative",children:[(0,s.jsx)(d,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),(0,s.jsx)(o.I,{placeholder:"Search for your school...",className:"pl-10 bg-white/5 border-white/10 h-12 text-white placeholder:text-white/30 focus:border-yollr-cyan/50 transition-colors",value:t,onChange:e=>r(e.target.value)})]})]})}},3102:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});var s=r(7437),a=r(2265),o=r(7440);let n=a.forwardRef((e,t)=>{let{className:r,type:a,...n}=e;return(0,s.jsx)("input",{type:a,className:(0,o.cn)("flex h-12 w-full rounded-xl border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});n.displayName="Input"},6474:(e,t,r)=>{"use strict";r.d(t,{e:()=>a});var s=r(3290);function a(){return(0,s.AY)("https://wdpiwrdesqtlzsuxfkwc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndkcGl3cmRlc3F0bHpzdXhma3djIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NTc4NTAsImV4cCI6MjA3ODAzMzg1MH0.-aFoHj7EtEA9k54of_gyIw5DAKDSZyJlT5b4N2sUXUY")}},7440:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var s=r(4839),a=r(6164);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}},1066:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),n=(e,t)=>{let r=(0,s.forwardRef)((r,n)=>{let{color:i="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:u="",children:h,...m}=r;return(0,s.createElement)("svg",{ref:n,...a,width:l,height:l,stroke:i,strokeWidth:d?24*Number(c)/Number(l):c,className:["lucide","lucide-".concat(o(e)),u].join(" "),...m},[...t.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(h)?h:[h]])});return r.displayName="".concat(e),r}},6463:(e,t,r)=>{"use strict";var s=r(1169);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[868,290,130,215,744],()=>t(3805)),_N_E=e.O()}]);