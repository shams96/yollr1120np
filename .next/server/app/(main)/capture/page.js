(()=>{var e={};e.id=412,e.ids=[412],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},8225:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var s=r(3003),a=r(4293),i=r(6550),l=r.n(i),n=r(6979),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let c=["",{children:["(main)",{children:["capture",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8133)),"C:\\Users\\New User\\dev\\hiest\\yollr1120NP\\app\\(main)\\capture\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8942)),"C:\\Users\\New User\\dev\\hiest\\yollr1120NP\\app\\(main)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,2075,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,6877)),"C:\\Users\\New User\\dev\\hiest\\yollr1120NP\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,2075,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\New User\\dev\\hiest\\yollr1120NP\\app\\(main)\\capture\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(main)/capture/page",pathname:"/capture",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9144:(e,t,r)=>{Promise.resolve().then(r.bind(r,8157))},8157:(e,t,r)=>{"use strict";r.d(t,{CameraView:()=>m});var s=r(8819),a=r(7266),i=r(5336),l=r(9758),n=r(6333),o=r(6557);let c=(0,o.Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),d=(0,o.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var u=r(5047),h=r(2945);function m(){let e=(0,a.useRef)(null),t=(0,a.useRef)(null),r=(0,a.useRef)(null),o=(0,a.useRef)([]),[m,p]=(0,a.useState)(null),[x,b]=(0,a.useState)(!1),[f,v]=(0,a.useState)("environment"),[g,w]=(0,a.useState)(!1),[k,y]=(0,a.useState)(null),[j,N]=(0,a.useState)(null),[C,P]=(0,a.useState)(0),z=(0,a.useRef)(null),_=(0,u.useRouter)(),[R,U]=(0,a.useState)(1),[M,q]=(0,a.useState)(null),S=(0,a.useCallback)(async()=>{m&&m.getTracks().forEach(e=>e.stop());try{let t=await navigator.mediaDevices.getUserMedia({video:{facingMode:f,width:{ideal:1920},height:{ideal:1080},aspectRatio:{ideal:9/16},zoom:!0},audio:!0});p(t),e.current&&(e.current.srcObject=t),y(null);let r=t.getVideoTracks()[0].getCapabilities();r.zoom?(q({min:r.zoom.min,max:r.zoom.max,step:r.zoom.step}),U(r.zoom.min)):q(null)}catch(e){console.error("Error accessing camera:",e),y("Could not access camera. Please check permissions.")}},[f]),E=async e=>{let t=parseFloat(e.target.value);if(U(t),m){let e=m.getVideoTracks()[0];try{await e.applyConstraints({advanced:[{zoom:t}]})}catch(e){console.error("Error setting zoom:",e)}}},L=()=>{if(!m)return;o.current=[];let e=new MediaRecorder(m);r.current=e,e.ondataavailable=e=>{e.data.size>0&&o.current.push(e.data)},e.onstop=()=>{let e=new Blob(o.current,{type:"video/webm"});N(URL.createObjectURL(e)),P(0),z.current&&clearInterval(z.current)},e.start(),b(!0);let t=Date.now();z.current=setInterval(()=>{let e=(Date.now()-t)/1e3;P(e),e>=15&&Z()},100)},Z=()=>{r.current&&"recording"===r.current.state&&(r.current.stop(),b(!1))},A=async()=>{if(j&&0!==o.current.length)try{let{data:{user:e}}=await (0,h.e)().auth.getUser();if(!e)return;let{data:t}=await (0,h.e)().from("heists").select("id").eq("status","submission").single();if(!t){console.error("No active heist found"),_.push("/feed");return}let{error:r}=await (0,h.e)().from("heist_submissions").insert({heist_id:t.id,user_id:e.id,video_url:"https://assets.mixkit.co/videos/preview/mixkit-man-dancing-under-changing-lights-1240-large.mp4",thumbnail_url:"https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=800&q=80",pitch_text:"Check out my heist plan! \uD83D\uDC7B",vote_count:0});if(r)throw r;_.push("/heist")}catch(e){console.error("Error submitting heist:",e),_.push("/heist")}};return j?(0,s.jsxs)("div",{className:"relative h-screen w-full bg-black",children:[(0,s.jsx)("video",{ref:t,src:j,autoPlay:!0,loop:!0,playsInline:!0,className:"h-full w-full object-cover"}),(0,s.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-8 flex justify-between items-center bg-gradient-to-t from-black/80 to-transparent",children:[(0,s.jsx)(i.z,{variant:"ghost",onClick:()=>{j&&URL.revokeObjectURL(j),N(null),b(!1)},className:"text-white hover:bg-white/20",children:"Retake"}),(0,s.jsx)(i.z,{onClick:A,className:"bg-yollr-peach hover:bg-yollr-peach/90 text-midnight font-bold px-8",children:"Post Moment"})]})]}):(0,s.jsxs)("div",{className:"relative h-screen w-full bg-black overflow-hidden",children:[k?(0,s.jsx)("div",{className:"flex h-full items-center justify-center text-white p-6 text-center",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(l.Z,{className:"h-12 w-12 mx-auto mb-4 text-red-500"}),(0,s.jsx)("p",{children:k}),(0,s.jsx)(i.z,{onClick:S,className:"mt-4",variant:"outline",children:"Retry"})]})}):(0,s.jsx)("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,className:`h-full w-full object-cover transition-transform duration-500 ${"user"===f?"scale-x-[-1]":""}`}),(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe flex justify-between items-center z-10 bg-gradient-to-b from-black/40 to-transparent",children:[(0,s.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>_.back(),className:"bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40",children:(0,s.jsx)(n.Z,{className:"h-6 w-6"})}),(0,s.jsx)("div",{className:"bg-black/20 backdrop-blur-md rounded-full px-3 py-1 text-white text-sm font-medium",children:x?`${Math.ceil(15-C)}s`:"15s"}),(0,s.jsx)(i.z,{variant:"ghost",size:"icon",className:"bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40",children:(0,s.jsx)(c,{className:"h-6 w-6"})})]}),M&&(0,s.jsx)("div",{className:"absolute bottom-32 left-0 right-0 px-12 flex items-center justify-center z-20",children:(0,s.jsxs)("div",{className:"bg-black/40 backdrop-blur-md rounded-full px-4 py-2 flex items-center space-x-2 w-full max-w-xs",children:[(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:"1x"}),(0,s.jsx)("input",{type:"range",min:M.min,max:M.max,step:M.step,value:R,onChange:E,className:"w-full h-1 bg-white/20 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:rounded-full"}),(0,s.jsxs)("span",{className:"text-white text-xs font-bold",children:[M.max,"x"]})]})}),(0,s.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-8 pb-12 flex justify-around items-center bg-gradient-to-t from-black/80 via-black/40 to-transparent",children:[(0,s.jsx)(i.z,{variant:"ghost",size:"icon",className:"opacity-0",children:(0,s.jsx)("div",{className:"h-10 w-10"})}),(0,s.jsxs)("div",{className:"relative",children:[x&&(0,s.jsxs)("svg",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-24 h-24 -rotate-90 pointer-events-none",children:[(0,s.jsx)("circle",{cx:"48",cy:"48",r:"46",stroke:"white",strokeWidth:"4",fill:"none",className:"opacity-30"}),(0,s.jsx)("circle",{cx:"48",cy:"48",r:"46",stroke:"#FF7A5C",strokeWidth:"4",fill:"none",strokeDasharray:289,strokeDashoffset:289-289*C/15,className:"transition-all duration-100 ease-linear"})]}),(0,s.jsx)("button",{onClick:()=>{x?Z():L()},className:`h-20 w-20 rounded-full border-[6px] border-white flex items-center justify-center transition-all duration-200 ${x?"bg-red-500 scale-90 border-transparent":"bg-transparent hover:scale-105"}`,children:x&&(0,s.jsx)("div",{className:"h-8 w-8 bg-white rounded-sm"})})]}),(0,s.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>{v(e=>"user"===e?"environment":"user")},disabled:!g,className:`bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40 transition-opacity ${g?"":"opacity-50"}`,children:(0,s.jsx)(d,{className:"h-6 w-6"})})]})]})}},6333:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6557).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8133:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>n});var a=r(9351),i=r(4687),l=e([i]);function n(){return(0,a.jsx)(i.CameraView,{})}i=(l.then?(await l)():l)[0],s()}catch(e){s(e)}})},4687:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{CameraView:()=>e});var a=r(1851);let e=(await (0,a.createProxy)(String.raw`C:\Users\New User\dev\hiest\yollr1120NP\components\features\camera\camera-view.tsx`)).CameraView;s()}catch(e){s(e)}},1)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[804,377,483,477,290],()=>r(8225));module.exports=s})();